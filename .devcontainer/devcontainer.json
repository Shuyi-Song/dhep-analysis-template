{
	"name": "R Data Science Environment",
	"build": {
		"dockerfile": "Dockerfile",
		"args": { "VARIANT": "4" }
	},

	// Install Dev Container Features
	"features": {
		"ghcr.io/rocker-org/devcontainer-features/quarto-cli:1": {},
		"ghcr.io/rocker-org/devcontainer-features/r-rig:1": {
			"version": "none",
			"installJupyterlab": true
		}
	},

	"customizations": {
		"vscode": {
			"extensions": [
				"ms-toolsai.jupyter",
				"ms-toolsai.jupyter-renderers",
				"ms-python.python",
				"ms-python.vscode-pylance",
				"vsls-contrib.codetour",
				"GitHub.copilot",
				"quarto.quarto"
			]
		}
	},

	// Forward Jupyter and RStudio ports
	"forwardPorts": [8787, 8888],
	"portsAttributes": {
		"8787": {
			"label": "RStudio",
			"requireLocalPort": true,
			"onAutoForward": "ignore"
		},
		"8888": {
			"label": "Jupyter",
			"requireLocalPort": true,
			"onAutoForward": "ignore"
		}
	},

	// Run command after container starts
	"postAttachCommand": "sudo rstudio-server start",

	// Documentation link
	"documentationURL": "https://github.com/rocker-org/devcontainer-features/tree/main/src/quarto-cli",

	// Additional options
	"options": {
		"version": {
			"type": "string",
			"proposals": ["latest", "prerelease"],
			"default": "latest",
			"description": "Select version of the Quarto CLI, if not latest."
		},
		"installTinyTex": {
			"type": "boolean",
			"default": false,
			"description": "Install TinyTeX by using the `quarto tools install tinytex` command. Works only with version 1.2 or later."
		},
		"installChromium": {
			"type": "boolean",
			"default": false,
			"description": "Run the `quarto tools install chromium` command. Check the document for details."
		}
	},

	// Environment variables for renv cache
	"containerEnv": {
		"RENV_PATHS_CACHE": "/renv/cache"
	},

	// Mounts for renv cache
	"mounts": [
		{
			"source": "devcontainer-renv-cache",
			"target": "/renv/cache",
			"type": "volume"
		}
	],

	// Command to execute on container start
	"postStartCommand": "/usr/local/share/rocker-devcontainer-features/renv-cache/scripts/poststart.sh",

	// Install order for features
	"installsAfter": [
		"ghcr.io/devcontainers/features/common-utils",
		"ghcr.io/rocker-org/devcontainer-features/apt-packages",
		"ghcr.io/rocker-org/devcontainer-features/r-apt",
		"ghcr.io/rocker-org/devcontainer-features/r-packages",
		"ghcr.io/rocker-org/devcontainer-features/r-rig"
	]
}
